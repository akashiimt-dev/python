import java.util.ArrayList;
import java.util.HashSet;
import java.util.List;
import java.util.Set;
import java.util.Arrays;

public class CountryAccessChecker {

    private List<Object[]> restrictedCountries;

    public CountryAccessChecker(List<Object[]> restrictedCountries) {
        this.restrictedCountries = restrictedCountries;
    }

    public Set<String> getRestrictedAccessCountries(List<String> requestFromList) {
        Set<String> restrictedAccessCountries = new HashSet<>();

        // Identify all restricted countries based on requestFrom countries
        for (String requestFrom : requestFromList) {
            for (Object[] countryRestriction : restrictedCountries) {
                String restrictedFromCountry = (String) countryRestriction[0];
                String restrictedCountryCodes = (String) countryRestriction[1];

                // If this requestFrom has any restrictions, add them to the restricted set
                if (restrictedFromCountry.equals(requestFrom)) {
                    restrictedAccessCountries.addAll(Arrays.asList(restrictedCountryCodes.split(",")));
                }
            }
        }

        return restrictedAccessCountries;
    }

    public List<String> getAllowedAccessList(List<String> requestFromList, List<String> requestToList) {
        // Get all restricted countries for the given requestFrom countries
        Set<String> restrictedAccessCountries = getRestrictedAccessCountries(requestFromList);

        // Prepare the final list of allowed access countries
        List<String> allowedAccessList = new ArrayList<>();
        
        for (String requestTo : requestToList) {
            // Add to allowed list only if requestTo is not in restricted countries
            if (!restrictedAccessCountries.contains(requestTo)) {
                allowedAccessList.add(requestTo);
            }
        }

        return allowedAccessList;
    }

    public static void main(String[] args) {
        // Define restricted countries in List<Object[]>
        List<Object[]> restrictedCountries = List.of(
            new Object[]{"IN", "PK,SG"},
            new Object[]{"PK", "KP,IN"}
        );

        CountryAccessChecker checker = new CountryAccessChecker(restrictedCountries);

        // Define requestFrom and requestTo lists
        List<String> requestFromList = List.of("IN", "US");
        List<String> requestToList = List.of("SG", "IN", "PK");

        // Get the final list of allowed access
        List<String> allowedAccessList = checker.getAllowedAccessList(requestFromList, requestToList);
        
        System.out.println("Allowed access can be raised for: " + allowedAccessList);
    }
}